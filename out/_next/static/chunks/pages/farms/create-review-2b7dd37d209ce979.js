(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3439],{40782:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/farms/create-review",function(){return n(97926)}])},82187:function(e,t,n){"use strict";n.d(t,{p:function(){return i}});var r=n(73944);let i=e=>{let t=null,n=[],i=[],a=[];function l(){let a=t||(null!=e?e:new r.YW);return(n.length||i.length)&&a.add(...n,...i.reverse()),a}return{setRawTransaction:function(e){t=e},addInstruction:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.push(...t)},addEndInstruction:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];i.push(...t)},addInnerTransactions:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a.push(...t)},spawnTransaction:l,spawnTransactionQueue:function(){return n.length||i.length?[...a,l()]:a}}}},92618:function(e,t,n){"use strict";n.d(t,{Z:function(){return f}});var r=n(85893),i=n(91371),a=n(37012),l=n(31139),s=n(50352),o=n(27993),d=n(67294),c=n(66180),u=n(6994),m=n(36868);function f(e){let{componentRef:t,className:n,panelClassName:o,arrowClassName:f,children:x,forceOpen:h,placement:p="top",triggerBy:Z,closeBy:g="click-outside-but-trigger",disable:b,defaultOpen:w,darkGradient:y=!1,autoClose:j,...N}=e,P=(0,d.useRef)(),T=(0,d.useMemo)(()=>(0,s.kp)(x,v,e=>(0,a.Z)(e,{$isRenderByMain:!0,$popoverRef:P})),[x]),k=(0,i.ZP)(e=>e.isMobile);return(0,r.jsxs)(m.Z,{componentRef:(0,l.Z)(t,P),canOpen:!b,placement:k?"top":p,defaultOpen:w,triggerBy:null!=Z?Z:k?"click":"hover",forceOpen:h,className:n,triggerDelay:100,closeBy:g,closeDelay:100,autoClose:j,...N,children:[(0,r.jsx)(m.Z.Button,{children:x}),(0,r.jsx)(m.Z.Panel,{children:e=>{let{locationInfo:t}=e;return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsx)("div",{className:(0,c.m)("w-2 h-2 absolute bg-[#0C0926] rotate-45 -translate-x-1 -translate-y-1",y?"bg-[transparent]":"",f),style:t?{top:t.arrowTopRelativeToPanel,left:t.arrowLeftRelativeToPanel}:{visibility:"hidden"}}),(0,r.jsx)(u.Z,{className:(0,c.m)("TooltipPanel p-4 bg-[#0C0926] rounded-lg text-xs text-white",o),style:{background:y?"linear-gradient(140.14deg, rgba(0, 182, 191, 0.15) 0%, rgba(27, 22, 89, 0.1) 86.61%), linear-gradient(321.82deg, #18134D 0%, #1B1659 100%)":"default",border:y?"1px solid  rgba(171, 196, 255, 0.2)":"none"},children:T})]})}})]})}function v(e){var t;let{$isRenderByMain:n,$popoverRef:i,children:a,className:l}=e;return n?(0,r.jsx)("div",{className:l,children:(0,o.u)(a,[null!==(t=null==i?void 0:i.current)&&void 0!==t?t:{}])}):null}f.Panel=v},14033:function(e,t,n){"use strict";n.d(t,{S:function(){return a}});var r=n(99881),i=n(84207);function a(e,t){var n;let a=e=>(0,r.Z)(e.toFixed(null!==(n=null==t?void 0:t.decimalPlace)&&void 0!==n?n:2,null==t?void 0:t.format,null==t?void 0:t.rounding),{fractionLength:"auto",...t}),l=(0,i.Z)(e);try{let e=l.toFixed(0),n=e.length;if(!(null==t?void 0:t.disabled)&&n>9)return"".concat(a(l.div(1e9)),"B");if(!(null==t?void 0:t.disabled)&&n>6)return"".concat(a(l.div(1e6)),"M");if(!(null==t?void 0:t.disabled)&&n>3)return"".concat(a(l.div(1e3)),"K");return"".concat(a(l))}catch(e){return"0"}}},99881:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(72573);function i(e){let{groupSeparator:t=",",fractionLength:n=2,groupSize:i=3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===e?"0":[e=>(0,r.B)(e),e=>"auto"===n?e:function(e,t){var n;let[,r="",i="",a=""]=null!==(n=e.match(/(-?)(\d*)\.?(\d*)/))&&void 0!==n?n:[];return a?a.length<t?String(e):Number(e).toFixed(t):String(e)}(e,n),e=>{var n;let[,r="",a="",l=""]=null!==(n=e.match(/(-?)(\d*)\.?(\d*)/))&&void 0!==n?n:[],s=[...a].reduceRight((e,n,r,a)=>{let l=a.length-1-r;return n+(0!==l&&l%i==0?t:"")+e},"");return l?"".concat(r).concat(s,".").concat(l):"".concat(r).concat(s)}].reduce((e,t)=>t(e),e)}},18074:function(e,t,n){"use strict";n.d(t,{Z:function(){return o}});var r=n(81451),i=n(51523),a=n(84207),l=n(72573),s=n(99881);function o(e,t){try{var n,o;let d=(0,a.Z)(null!=e?e:0),c=d.mul((null==t?void 0:t.alreadyPercented)?1:100).toFixed(null!==(n=null==t?void 0:t.fixed)&&void 0!==n?n:2);if((0,r.eq)(d,0))return"0%";if(!(null==t?void 0:t.exact)&&c===0..toFixed(null!==(o=null==t?void 0:t.fixed)&&void 0!==o?o:2))return(null==t?void 0:t.alwaysSigned)?"<+0.01%":"<0.01%";return(null==t?void 0:t.alwaysSigned)?"".concat((0,r.gt)(c,0)?"+":"-").concat((0,s.Z)((0,r.gt)(c,0)?(0,l.B)(c):(0,l.B)((0,i.dC)(c,-1))),"%"):"".concat((0,s.Z)(c,{fractionLength:null==t?void 0:t.fixed}),"%")}catch(e){return"0%"}}},95865:function(e,t,n){"use strict";n.d(t,{Z:function(){return i}});var r=n(14033);function i(e,t){return e?"$".concat((0,r.S)(e,{...t,disabled:!(null==t?void 0:t.autoSuffix)})):"$0"}},56053:function(e,t,n){"use strict";n.d(t,{j:function(){return g}});var r=n(85893),i=n(91371),a=n(13521),l=n(57435),s=n(2148),o=n(31166),d=n(99522),c=n(54531),u=n(54592),m=n(48162),f=n(34495),v=n(51800),x=n(92618),h=n(3363),p=n(18074),Z=n(95865);function g(){let e=(0,a.Z)(e=>e.poolId),t=(0,s.O)(e=>e.hydratedInfos),n=(0,l.Z)(e=>e.jsonInfos),g=(0,o.ZP)(e=>e.tokens),b=(0,i.ZP)(e=>e.isMobile),w=n.find(t=>(0,h.ZP)(t.id)===e),y=t.find(t=>t.ammId===e),j={...w,...y,baseToken:w?g[w.baseMint]:void 0,quoteToken:w?g[w.quoteMint]:void 0};return(0,r.jsx)(f.Z,{type:b?"item-card":"list-table",itemClassName:b?"grid-cols-[1fr,2fr]":void 0,list:[{id:e,pool:j}],getItemKey:e=>e.id,labelMapper:[{label:"Pool",cssGridItemWidth:"2fr"},{label:"TVL"},{label:"APR",renderLabel:()=>(0,r.jsxs)(v.Z,{children:[(0,r.jsx)("div",{children:"APR"}),(0,r.jsxs)(x.Z,{children:[(0,r.jsx)(m.Z,{className:"ml-1 cursor-help",size:"sm",heroIconName:"question-mark-circle"}),(0,r.jsx)(x.Z.Panel,{children:(0,r.jsx)("div",{className:"max-w-[300px]",children:"APR based on trading fees earned by the pool in the past 30D. Farming reward APR will be calculated once the farm is live and users have staked."})})]})]})}],renderRowItem:e=>{var t,n,i,a,l,s,o,m,f,x;let{item:g,label:b}=e;return"Pool"===b?g.id?(0,r.jsxs)(v.Z,{className:"gap-1 items-center",children:[(0,r.jsx)(c.Z,{token1:null===(t=g.pool)||void 0===t?void 0:t.baseToken,token2:null===(n=g.pool)||void 0===n?void 0:n.quoteToken,size:"sm"}),(0,r.jsxs)("div",{children:[(0,r.jsxs)("div",{children:[null!==(m=null===(i=g.pool)||void 0===i?void 0:null===(a=i.baseToken)||void 0===a?void 0:a.symbol)&&void 0!==m?m:"UNKNOWN","-",null!==(f=null===(l=g.pool)||void 0===l?void 0:null===(s=l.quoteToken)||void 0===s?void 0:s.symbol)&&void 0!==f?f:"UNKNOWN"]}),(0,r.jsx)(d.U,{showDigitCount:8,textClassName:"text-[#abc4ff80] text-xs",canCopy:!1,children:(0,h.ZP)(null===(o=g.pool)||void 0===o?void 0:o.ammId)})]})]}):"--":"TVL"===b?(0,r.jsx)(u.Z,{className:"justify-center h-full",children:(null===(x=g.pool)||void 0===x?void 0:x.liquidity)?(0,Z.Z)(g.pool.liquidity,{decimalPlace:0}):"--"}):"APR"===b?(0,r.jsx)(u.Z,{className:"justify-center h-full",children:g.pool.apr30d?(0,p.Z)(g.pool.apr30d,{alreadyPercented:!0}):"--"}):void 0}})}},97926:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return V}});var r=n(85893),i=n(91371),a=n(95657),l=n(72305),s=n(82187),o=n(79938),d=n(91148),c=n(34003),u=n(98360),m=n(56419),f=n(90547),v=n(9191),x=n(3363),h=n(4465),p=n(14209),Z=n(51523),g=n(71375),b=n(53607),w=n(57435),y=n(2148),j=n(42186),N=n(80582),P=n(53002),T=n(59277),k=n(13521),I=n(43724);async function S(e){let{onReceiveFarmId:t,...n}=e;return(0,o.ZP)(async e=>{let{transactionCollector:r,baseUtils:{owner:i,connection:a}}=e,{rewards:o}=k.Z.getState(),{valid:S,reason:R}=(0,I.zh)();(0,c.Z)(S,R);let{valid:C,reason:A}=(0,I.f6)(o);(0,c.Z)(C,A);let{tokenAccounts:F,tokenAccountRawInfos:E}=P.Z.getState();(0,s.p)();let{poolId:M}=k.Z.getState(),{jsonInfos:B}=w.Z.getState(),{programIds:D}=T.ZP.getState(),O=B.find(e=>e.id===M),q=F.map(e=>(0,x.ZP)(e.mint));(0,c.Z)(O,"pool json info not founded");let _=o.map(e=>{var t,n;let r=e.token;if((0,c.Z)(e.startTime,"reward start time is required"),(0,c.Z)(e.endTime,"reward end time is required"),(0,c.Z)(e.amount,"reward amount is required"),!(0,h.aT)(null===(t=e.token)||void 0===t?void 0:t.mint,j.DA)){let t=q.includes((0,x.ZP)(null===(n=e.token)||void 0===n?void 0:n.mint));(0,c.Z)(t,"token not existed in user's wallet")}(0,c.Z)(r,"can't find selected reward token");let i=(0,m.V1)(e.startTime).getTime(),a=(0,m.V1)(e.endTime).getTime(),l=(0,Z.hi)(e.amount,(0,f.nB)(a-i).seconds),s=(0,g.Z)((0,Z.dC)(l,(0,p.Bd)(1,r.decimals)));return{rewardOpenTime:(0,g.Z)((0,Z.hi)(i,1e3)),rewardEndTime:(0,g.Z)((0,Z.hi)(a,1e3)),rewardMint:"sol"===r.id?N.YG:r.mint,rewardPerSecond:s,rewardType:e.isOptionToken?"Option tokens":"Standard SPL"}}),L="4k3Dyjzvzp8eMZWUXbBCjEvwSkkk59S5iCNLY3QrkX6R",Y=O.lpMint,K=F.find(e=>(0,h.aT)(e.mint,L));(0,c.Z)(null==K?void 0:K.publicKey,"lockMintTokenAccount not found");let{innerTransaction:V,address:U}=await l.l6j.makeCreateFarmInstruction({poolInfo:{lpMint:(0,x.uI)(Y),lockInfo:{lockMint:(0,x.uI)(L),lockVault:(0,x.uI)("FrspKwj8i3pNmKwXreTveC4fu7KL5ZbGeXdZBe2XViu1")},version:6,rewardInfos:_,programId:D.FarmV6},connection:a,userKeys:{owner:i,tokenAccounts:E}}),X=(0,x.ZP)(U.farmId);async function z(){let{poolId:e,farmId:t}=k.Z.getState(),{jsonInfos:n}=y.O.getState();if(!e||!t)return;let r=n.find(t=>t.ammId===e);if(!r)return;let a=r.lpMint,s=D.FarmV6,o=(0,x.ZP)((await l.l6j.getAssociatedAuthority({programId:s,poolId:(0,x.uI)(e)})).publicKey),c=(0,x.ZP)(l.l6j.getAssociatedLedgerPoolAccount({programId:s,poolId:(0,x.uI)(t),mint:(0,x.uI)(a),type:"lpVault"})),m={id:t,lpMint:a,version:6,programId:(0,x.ZP)(s),authority:o,lpVault:c,rewardPeriodMax:b.DX,rewardPeriodMin:b.x4,rewardPeriodExtend:b.Md,upcoming:!0,creator:(0,x.ZP)(i),rewardInfos:await (0,u.ZP)(_,async t=>{let n=(0,x.ZP)(await l.l6j.getAssociatedLedgerPoolAccount({programId:s,poolId:(0,x.uI)(e),mint:(0,x.uI)(t.rewardMint),type:"rewardVault"}));return{rewardMint:(0,x.ZP)(t.rewardMint),rewardOpenTime:(0,g.Z)(t.rewardOpenTime).toNumber(),rewardEndTime:(0,g.Z)(t.rewardEndTime).toNumber(),rewardPerSecond:(0,g.Z)(t.rewardPerSecond).toNumber(),rewardVault:n,rewardType:t.rewardType}})};(0,v.mM)("USER_CREATED_FARMS",e=>(0,d.jX)(null!=e?e:[],m))}null==t||t(X),(0,c.Z)(V,"createFarm valid failed"),r.add(V,{...n,cacheTransaction:!0,txHistoryInfo:{title:"Create New Farm",description:"Farm ID: ".concat(X.slice(0,4),"...").concat(X.slice(-4))},onTxSuccess(){for(var e,t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];z(),null===(e=n.onTxSuccess)||void 0===e||e.call(n,...r)}})})}var R=n(49641),C=n(31555),A=n(99522),F=n(43067),E=n(54592),M=n(42885),B=n(51800),D=n(81451),O=n(72573),q=n(92224),_=n(3113),L=n(56053),Y=n(11163),K=n(67294);function V(){var e;let[t,{on:n,off:l}]=(0,q.ZP)(!1),s=(0,P.Z)(e=>e.balances),o=(0,k.Z)(e=>e.rewards),{pathname:d}=(0,Y.useRouter)(),c=(0,i.ZP)(e=>e.isMobile),u=(0,R.Z)(e=>e.refreshFarmInfos),[m,f]=(0,K.useState)(String(Date.now())),v=(0,i.ZP)(e=>e.isApprovePanelShown);(0,K.useEffect)(()=>{f(String(Date.now()))},[d]);let p=null===(e=o.find(e=>{var t;return(0,h.aT)(null===(t=e.token)||void 0===t?void 0:t.mint,N.PD)}))||void 0===e?void 0:e.amount,g=s[(0,x.ZP)(N.PD)],b=(0,D.eg)(null!=g?g:0,(0,Z.IH)(0,null!=p?p:300));(0,K.useEffect)(()=>{k.Z.getState().isRoutedByCreateOrEdit||(0,C.Eh)("/farms",{queryProps:{currentTab:"Ecosystem"}})},[]);let w=(0,r.jsx)(F.Z,{className:"frosted-glass-teal px-16 self-stretch mobile:w-full",isLoading:v,size:c?"sm":"lg",validators:[{should:b,fallbackProps:{children:"Insufficient RAY balance"}}],onClick:async()=>{S({onReceiveFarmId(e){k.Z.setState({farmId:e})},onTxSentFinally:()=>{n(),function(e,t){var n;let r=0;if(0<(null!==(n=t.loopCount)&&void 0!==n?n:1/0)){let n=globalThis.setInterval(()=>{var i;e(),(r+=1)>=(null!==(i=t.loopCount)&&void 0!==i?i:1/0)&&globalThis.clearInterval(n)},t.intervalTime)}}(()=>{R.Z.getState().refreshFarmInfos()},{loopCount:3,intervalTime:6e4})}})},children:"Create Farm"}),y=(0,r.jsxs)(E.Z,{className:"mt-4 text-sm font-medium items-center",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-[#abc4ff80]",children:"Fee:"})," ",(0,r.jsx)("span",{className:"text-[#abc4ff]",children:"300 RAY"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("span",{className:"text-[#abc4ff80]",children:"Est. transaction fee:"})," ",(0,r.jsx)("span",{className:"text-[#abc4ff]",children:"0.002 SOL"})]})]}),j=(0,r.jsx)(F.Z,{className:"frosted-glass-skygray mobile:w-full",size:c?"sm":"lg",onClick:C.Bv,children:"Edit"});return(0,r.jsx)(M.Z,{metaTitle:"Farms - Raydium",mobileBarTitle:"Create Farm",children:(0,r.jsxs)("div",{className:"self-center w-[min(720px,90vw)] py-4",children:[!c&&(0,r.jsx)("div",{className:"pb-8 text-2xl mobile:text-lg font-semibold justify-self-start text-white",children:"Create Farm"}),(0,r.jsx)("div",{className:"mb-8 text-xl mobile:text-lg font-semibold justify-self-start text-white",children:"Review farm details"}),(0,r.jsxs)("div",{className:"mb-8",children:[(0,r.jsx)("div",{className:"mb-3 text-[#abc4ff] text-sm font-medium justify-self-start",children:"Pool"}),(0,r.jsx)(L.j,{})]}),(0,r.jsxs)("div",{className:"mb-6",children:[(0,r.jsx)("div",{className:"mb-3 text-[#abc4ff] text-sm font-medium justify-self-start",children:"Farm rewards"}),(0,r.jsx)(_.D,{canUserEdit:!1})]}),(0,r.jsxs)("div",{className:"font-medium text-sm mobile:text-xs text-justify leading-snug text-[#abc4ff80] mb-8",children:[(0,r.jsx)("span",{className:"text-[#DA2EEF]",children:"Please note:"})," Rewards allocated to farms cannot be withdrawn after farming starts. Newly created farms generally appear on Raydium 10-30 minutes after creation, depending on Solana network status. A one-time fee of 300 RAY is required to create a farm, which will be deposited into the Raydium treasury."]}),t?(0,r.jsx)("div",{className:"text-[#39d0d8] font-medium text-center text-sm my-4 mobile:mx-4",children:"Your farm has been created successfully and will be live on the UI shortly"}):(0,r.jsxs)("div",{className:"text-[#DA2EEF] font-medium text-center text-sm my-4 mobile:mx-4",children:["Creating a farm requires a one-time 300 RAY fee. Your RAY balance: ",(0,O.B)(g)||0," RAY"]}),t?(0,r.jsxs)(E.Z,{children:[(0,r.jsxs)(B.Z,{className:"w-full gap-2 justify-center my-8",children:[(0,r.jsx)(B.Z,{className:"items-center text-sm mobile:text-xs font-medium text-[#ABC4FF] mobile:text-2xs",children:(0,r.jsx)("div",{className:"mr-1",children:"Your Farm ID: "})}),(0,r.jsx)(A.U,{canCopy:!0,showDigitCount:"all",className:"text-white mobile:text-sm font-medium",children:k.Z.getState().farmId})]}),(0,r.jsx)(F.Z,{className:"frosted-glass-skygray mobile:w-full",size:c?"sm":"lg",onClick:()=>{(0,C.Eh)("/farms",{queryProps:{currentTab:"Ecosystem"}}),u(),setTimeout(()=>{k.Z.setState({rewards:[(0,a.k8)()]}),k.Z.setState({isRoutedByCreateOrEdit:!1}),l()},1e3)},children:"Back to Farms"})]}):c?(0,r.jsxs)(E.Z,{className:"gap-5 items-center",children:[y,(0,r.jsxs)(E.Z,{className:"items-center gap-3 w-full",children:[w,j]})]}):(0,r.jsxs)(B.Z,{className:"gap-5 justify-center items-start",children:[(0,r.jsxs)(E.Z,{className:"items-center",children:[w,y]}),j]})]})})}}},function(e){e.O(0,[4740,2885,2820,3129,9774,2888,179],function(){return e(e.s=40782)}),_N_E=e.O()}]);