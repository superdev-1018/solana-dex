(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6339],{29149:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/farms/edit-review",function(){return n(72011)}])},70745:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});var i=n(85893);n(67294);var s=n(66180),a=n(40471);function r(e){var t;let{noCoinIconBorder:n,haveAnime:r,iconSrc:l,token:d,isOptionToken:o,domRef:c,className:m,size:u="md",style:f,isRewardBadge:v,isRewardEnd:x,onClick:h}=e,w=null!==(t=null!=l?l:null==d?void 0:d.icons)&&void 0!==t?t:null==d?void 0:d.icon,j=!n,g="2xl"===u?"h-20 w-20":"lg"===u?"h-12 w-12":"md"===u?"h-8 w-8":"sm"===u?"h-5 w-5":"smi"===u?"h-6 w-6":"xs"===u?"w-4 h-4":"h-12 w-12";return(0,i.jsxs)(i.Fragment,{children:[x&&(0,i.jsx)(a.Z,{className:"h-8 w-8 rounded-full overflow-hidden ",src:"/icons/diagonal.svg",fallbackSrc:"/coins/unknown.svg",style:{position:"absolute",zIndex:100,opacity:20}}),(0,i.jsx)("div",{ref:c,className:"CoinAvatar flex items-center  ".concat(v?"rounded-full ring-1 ring-[#616A9D] p-1":""," ").concat(x?"opacity-30 ring-[#7B7EAF]":""," "),style:f,onClick:h,children:r?(0,i.jsxs)("div",{className:(0,s.m)("".concat(g," rounded-full swap-coin"),m),suppressHydrationWarning:!0,style:{"--delay":"".concat((1e3*Math.random()).toFixed(2),"ms")},children:[(0,i.jsx)(a.Z,{className:"front-face overflow-hidden transition-transform transform ".concat(j?"scale-[.7]":""),src:w,fallbackSrc:"/coins/unknown.svg"}),(0,i.jsxs)("div",{className:"line-group",children:[(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})}),(0,i.jsx)("div",{className:"line-out",children:(0,i.jsx)("div",{className:"line-inner"})})]}),(0,i.jsx)(a.Z,{className:"back-face overflow-hidden transition-transform transform ".concat(j?"scale-[.7]":""),src:w,fallbackSrc:"/coins/unknown.svg"})]}):(0,i.jsxs)("div",{className:(0,s.m)("".concat(g," relative rounded-full"),m),style:{background:"linear-gradient(126.6deg, rgba(171, 196, 255, 0.2) 28.69%, rgba(171, 196, 255, 0) 100%)"},children:[(0,i.jsx)(a.Z,{className:"".concat(g," rounded-full overflow-hidden transition-transform transform ").concat(j?"scale-[.7]":""),src:w,fallbackSrc:"/coins/unknown.svg"}),!1]})})]})}},14033:function(e,t,n){"use strict";n.d(t,{S:function(){return a}});var i=n(99881),s=n(84207);function a(e,t){var n;let a=e=>(0,i.Z)(e.toFixed(null!==(n=null==t?void 0:t.decimalPlace)&&void 0!==n?n:2,null==t?void 0:t.format,null==t?void 0:t.rounding),{fractionLength:"auto",...t}),r=(0,s.Z)(e);try{let e=r.toFixed(0),n=e.length;if(!(null==t?void 0:t.disabled)&&n>9)return"".concat(a(r.div(1e9)),"B");if(!(null==t?void 0:t.disabled)&&n>6)return"".concat(a(r.div(1e6)),"M");if(!(null==t?void 0:t.disabled)&&n>3)return"".concat(a(r.div(1e3)),"K");return"".concat(a(r))}catch(e){return"0"}}},99881:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(72573);function s(e){let{groupSeparator:t=",",fractionLength:n=2,groupSize:s=3}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return void 0===e?"0":[e=>(0,i.B)(e),e=>"auto"===n?e:function(e,t){var n;let[,i="",s="",a=""]=null!==(n=e.match(/(-?)(\d*)\.?(\d*)/))&&void 0!==n?n:[];return a?a.length<t?String(e):Number(e).toFixed(t):String(e)}(e,n),e=>{var n;let[,i="",a="",r=""]=null!==(n=e.match(/(-?)(\d*)\.?(\d*)/))&&void 0!==n?n:[],l=[...a].reduceRight((e,n,i,a)=>{let r=a.length-1-i;return n+(0!==r&&r%s==0?t:"")+e},"");return r?"".concat(i).concat(l,".").concat(r):"".concat(i).concat(l)}].reduce((e,t)=>t(e),e)}},95865:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var i=n(14033);function s(e,t){return e?"$".concat((0,i.S)(e,{...t,disabled:!(null==t?void 0:t.autoSuffix)})):"0"}},72011:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var i=n(85893),s=n(91371),a=n(95657),r=n(75640),l=n(8667),d=n(34003),o=n(98360),c=n(56419),m=n(90547),u=n(3363),f=n(4465),v=n(14209),x=n(51523),h=n(71375),w=n(49641),j=n(42186),g=n(80582),N=n(19036),Z=n(53002),b=n(13521),p=n(43724);async function k(e){let{...t}=e;return(0,l.ZP)(async e=>{let{transactionCollector:n,baseUtils:{owner:i,connection:s}}=e,{hydratedInfos:l}=w.Z.getState(),{rewards:k,farmId:y}=b.Z.getState(),T=l.find(e=>(0,u.ZP)(e.id)===y);(0,d.Z)(y,"target farm id is missing"),(0,d.Z)(T,"can't find target farm");let S=k.filter(e=>(0,a.uk)(e)&&"existed reward"===e.type),E=k.filter(e=>"new added"===e.type),{valid:C,reason:P}=(0,p.f6)(E);(0,d.Z)(C,P);let F=await (0,o.ZP)(S,async e=>{let{innerTransactions:t}=await function(e){var t,n,i,s;let{connection:a,reward:l,farmInfo:o}=e,{owner:u,tokenAccountRawInfos:w}=Z.Z.getState();(0,d.Z)(u&&(0,f.aT)(u,l.owner),"reward is not created by walletOwner"),(0,d.Z)(l.token,"reward must have token"),(0,d.Z)(l.endTime,"reward must have endTime"),(0,d.Z)(null===(t=l.originData)||void 0===t?void 0:t.endTime,"reward's originData must have endTime"),(0,d.Z)(l.startTime,"reward must have startTime"),(0,d.Z)(l.amount,"reward must have amount"),(0,d.Z)(l.owner,"reward must have creator");let b=(0,c.V1)(l.startTime).getTime(),p=(0,c.V1)(l.endTime).getTime(),k=(0,x.hi)(l.amount,(0,m.nB)(p-b).seconds),y={rewardMint:(0,j.Dn)(l.token)?g.YG:null===(n=l.token)||void 0===n?void 0:n.mint,rewardOpenTime:(0,h.Z)((0,x.hi)(b,1e3)).toNumber(),rewardEndTime:(0,h.Z)((0,x.hi)(p,1e3)).toNumber(),rewardPerSecond:(0,h.Z)((0,x.dC)(k,(0,v.Bd)("1",null!==(s=null===(i=l.token)||void 0===i?void 0:i.decimals)&&void 0!==s?s:6))),rewardType:l.isOptionToken?"Option tokens":"Standard SPL"};return r.l6j.makeRestartFarmInstructionSimple({poolKeys:(0,N.R)(o.jsonInfo),connection:a,userKeys:{owner:u,tokenAccounts:w},newRewardInfo:y})}({reward:e,farmInfo:T,connection:s});return t}),_=await (0,o.ZP)(E,async e=>{let{innerTransactions:t}=await function(e){let{connection:t,reward:n,farmInfo:i}=e,{owner:s,tokenAccountRawInfos:a}=Z.Z.getState();(0,d.Z)(s,"Wallet not connected");let l=n.token;(0,d.Z)(n.startTime,"reward start time is required"),(0,d.Z)(n.endTime,"reward end time is required"),(0,d.Z)(n.amount,"reward amount is required"),(0,d.Z)(l,"can't find selected reward token");let o=(0,c.V1)(n.startTime).getTime(),u=(0,c.V1)(n.endTime).getTime(),f=(0,x.hi)(n.amount,(0,m.nB)(u-o).seconds),w={rewardOpenTime:(0,h.Z)((0,x.hi)(o,1e3)),rewardEndTime:(0,h.Z)((0,x.hi)(u,1e3)),rewardMint:(0,j.Dn)(l)?g.YG:l.mint,rewardPerSecond:(0,h.Z)((0,x.dC)(f,(0,v.Bd)(1,l.decimals))),rewardType:n.isOptionToken?"Option tokens":"Standard SPL"};return r.l6j.makeFarmCreatorAddRewardTokenInstructionSimple({poolKeys:(0,N.R)(i.jsonInfo),connection:t,userKeys:{owner:s,tokenAccounts:a},newRewardInfo:w})}({reward:e,farmInfo:T,connection:s});return t});n.add([...F.flat(),..._.flat()],{...t,txHistoryInfo:{title:"Edit Farm",description:"(Click to see details)"}})})}var y=n(31555),T=n(31166),S=n(99522),E=n(43067),C=n(54592),P=n(57571),F=n(51800),_=n(44516),B=n(28723),I=n(3113),O=n(56053),R=n(67294);function D(){let e=(0,T.ZP)(e=>e.getToken),{poolId:t,rewards:n,farmId:r}=(0,b.Z)(),l=(0,s.ZP)(e=>e.isApprovePanelShown),o=(0,s.ZP)(e=>e.isMobile);(0,R.useMemo)(()=>(0,_.Z)(()=>((0,d.Z)(t,"poolId is not defined"),n.forEach(e=>{(0,d.Z)(e.amount,"reward amount is not defined"),(0,d.Z)(e.token,"reward token is not defined"),(0,d.Z)(e.startTime,"reward start time is not defined"),(0,d.Z)(e.endTime,"reward end time is not defined")}),!0),()=>!1),[t,n,e]);let c=n.filter(e=>"new added"===e.type),m=n.filter(e=>(0,a.uk)(e));(0,R.useEffect)(()=>{b.Z.getState().isRoutedByCreateOrEdit||(0,y.Eh)("/farms",{queryProps:{currentTab:"Ecosystem"}})},[]);let u=(0,i.jsx)(E.Z,{className:"frosted-glass-teal",isLoading:l,size:o?"sm":"lg",validators:[{should:c.length>0||m.length>0}],onClick:()=>{k({onTxSuccess:()=>{setTimeout(()=>{(0,y.Eh)("/farms",{queryProps:{currentTab:"Ecosystem"}}),b.Z.setState({rewards:[(0,a.k8)()]}),w.Z.getState().refreshFarmInfos(),b.Z.setState({isRoutedByCreateOrEdit:!1})},1e3)}})},children:"Confirm Farm Changes"}),f=(0,i.jsx)(E.Z,{className:"frosted-glass-skygray mobile:w-full",size:o?"sm":"lg",onClick:y.Bv,children:"Edit"});return(0,i.jsx)(P.Z,{metaTitle:"Farms - Raydium",mobileBarTitle:"Edit Farm",children:(0,i.jsxs)("div",{className:"self-center w-[min(720px,90vw)]",children:[!o&&(0,i.jsxs)(F.Z,{className:"mb-8 justify-self-start items-baseline gap-2",children:[(0,i.jsx)("div",{className:"text-2xl mobile:text-lg font-semibold text-white",children:"Edit Farm"}),r&&(0,i.jsxs)("div",{className:"text-sm mobile:text-xs font-semibold text-[#abc4ff80]",children:["Farm ID:",(0,i.jsx)("div",{className:"inline-block ml-1",children:(0,i.jsx)(S.U,{className:"flex-nowrap whitespace-nowrap",canCopy:!0,iconClassName:"hidden",textClassName:"text-sm mobile:text-xs font-semibold text-[#abc4ff80] whitespace-nowrap",showDigitCount:6,children:r})})]})]}),(0,i.jsx)("div",{className:"mb-8 text-xl mobile:text-lg font-semibold justify-self-start text-white",children:"Review farm details"}),(0,i.jsxs)("div",{className:"mb-8",children:[(0,i.jsx)("div",{className:"mb-3 text-[#abc4ff] text-sm font-medium justify-self-start",children:"Pool"}),(0,i.jsx)(O.j,{})]}),(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("div",{className:"mb-3 text-[#abc4ff] text-sm font-medium justify-self-start",children:"Existing farm rewards"}),(0,i.jsx)(B.t,{canUserEdit:!1})]}),c.length>0&&(0,i.jsxs)("div",{className:"mb-6",children:[(0,i.jsx)("div",{className:"mb-3 text-[#abc4ff] text-sm font-medium justify-self-start",children:"New farm rewards"}),(0,i.jsx)(I.D,{canUserEdit:!1})]}),o?(0,i.jsxs)(C.Z,{className:"gap-3 mt-12 justify-center",children:[u,f]}):(0,i.jsxs)(F.Z,{className:"gap-5 mt-12 justify-center",children:[u,f]})]})})}}},function(e){e.O(0,[4740,7571,8667,3129,6523,9774,2888,179],function(){return e(e.s=29149)}),_N_E=e.O()}]);