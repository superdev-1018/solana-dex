"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4847],{77023:function(e,t,n){n.d(t,{Z:function(){return u}});var r=n(75640),o=n(8667),a=n(62707),l=n(34003),s=n(19036),i=n(53002),c=n(49641);async function u(e,t){return(0,o.ZP)(async n=>{let{transactionCollector:o,baseUtils:{owner:u,connection:d}}=n;(0,l.Z)(u,"require connected wallet");let f=c.Z.getState().jsonInfos.find(t=>{let{id:n}=t;return String(n)===String(e.id)});(0,l.Z)(f,"Farm pool not found");let m=(0,s.R)(f),p=r.l6j.getAssociatedLedgerAccount({programId:m.programId,poolId:m.id,owner:u,version:m.version}),h=[];if(!e.ledger&&f.version<6){let{innerTransaction:e}=r.l6j.makeCreateAssociatedLedgerAccountInstruction({poolKeys:m,userKeys:{owner:u,ledger:p}});h.push(e)}let{tokenAccountRawInfos:g}=i.Z.getState(),{innerTransactions:v}=await r.l6j.makeDepositInstructionSimple({connection:d,poolKeys:m,fetchPoolInfo:e.fetchedMultiInfo,ownerInfo:{feePayer:u,wallet:u,tokenAccounts:g},amount:t.amount.raw});h.push(...v);let k=(0,a.AX)(()=>{c.Z.getState().refreshFarmInfos()},{once:!0});o.add(h,{onTxError:()=>(0,a.Ce)(k),onTxSentError:()=>(0,a.Ce)(k),txHistoryInfo:{title:"Add ".concat(t.amount.token.symbol),description:"Stake ".concat(t.amount.toExact()," ").concat(t.amount.token.symbol)}})})}},1151:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(75640),o=n(82187),a=n(8667),l=n(62707),s=n(34003),i=n(19036),c=n(53002),u=n(49641);async function d(e,t){return(0,a.ZP)(async n=>{let{transactionCollector:a,baseUtils:{owner:d,connection:f}}=n,m=(0,o.p)();(0,s.Z)(d,"require connected wallet");let p=u.Z.getState().jsonInfos.find(t=>{let{id:n}=t;return String(n)===String(e.id)});(0,s.Z)(p,"Farm pool not found");let h=(0,i.R)(p),g=await r.l6j.getAssociatedLedgerAccount({programId:h.programId,poolId:h.id,owner:d,version:h.version});if(!e.ledger&&p.version<6){let{innerTransaction:e}=await r.l6j.makeCreateAssociatedLedgerAccountInstruction({poolKeys:h,userKeys:{owner:d,ledger:g}});m.addInnerTransactions(e)}let{tokenAccountRawInfos:v}=c.Z.getState(),k=r.l6j.makeWithdrawInstructionSimple({connection:f,fetchPoolInfo:e.fetchedMultiInfo,ownerInfo:{feePayer:d,wallet:d,tokenAccounts:v},amount:t.amount.raw});m.addInnerTransactions(...(await k).innerTransactions);let w=(0,l.AX)(()=>{u.Z.getState().refreshFarmInfos()},{once:!0});a.add(m.spawnTransactionQueue(),{onTxError:()=>(0,l.Ce)(w),onTxSentError:()=>(0,l.Ce)(w),txHistoryInfo:{title:"Unstake ".concat(t.amount.token.symbol),description:"Unstake ".concat(t.amount.toExact()," ").concat(t.amount.token.symbol)}})})}},82187:function(e,t,n){n.d(t,{p:function(){return o}});var r=n(47511);let o=e=>{let t=null,n=[],o=[],a=[];function l(){let a=t||(null!=e?e:new r.YW);return(n.length||o.length)&&a.add(...n,...o.reverse()),a}return{setRawTransaction:function(e){t=e},addInstruction:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];n.push(...t)},addEndInstruction:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];o.push(...t)},addInnerTransactions:function(){for(var e=arguments.length,t=Array(e),n=0;n<e;n++)t[n]=arguments[n];a.push(...t)},spawnTransaction:l,spawnTransactionQueue:function(){return n.length||o.length?[...a,l()]:a}}}},33674:function(e,t,n){n.d(t,{Z:function(){return h}});var r=n(85893),o=n(67294),a=n(66180),l=n(91371),s=n(14431),i=n(85503);function c(){let{run:e=!0,initPercent:t=0,componentRef:n,className:l,duration:c=6e4,strokeWidth:u=3,updateDelay:d=1e3,svgWidth:f=36,loop:m=!0,onEnd:p,onClick:h}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},g=.5*f/2,v=2*g*Math.PI,k=(0,o.useRef)(!1),{documentVisible:w}=(0,i.x)(),[b,x]=(0,o.useState)(t),Z=(0,o.useRef)(),S=(0,o.useRef)(null);(0,s.e)(S,{onClick:h,disable:!h}),(0,o.useEffect)(()=>{if(e&&w){let t=globalThis.setInterval(()=>{e&&w&&x(e=>e+1/c*d)},d);return Z.current=t,()=>globalThis.clearInterval(t)}globalThis.clearInterval(Z.current)},[c,d,e&&w]);let I=(0,o.useRef)();return(0,o.useEffect)(()=>{if(w&&I.current){let e=Date.now()-I.current;x(t=>t+1/c*e)}w||(I.current=Date.now())},[w]),(0,o.useEffect)(()=>{if(0==b||Math.round(100*b)/100!=0)return;let e=setTimeout(()=>{k.current||(k.current=!0,null==p||p(),setTimeout(()=>{k.current=!1},0))},0);return()=>clearTimeout(e)},[b]),(0,o.useImperativeHandle)(n,()=>({currentProgressPercent:b%1,restart(){x(0)}})),(0,r.jsx)("div",{className:(0,a.m)("w-full h-full rounded",l),children:(0,r.jsxs)("svg",{ref:S,width:f,height:f,viewBox:"0 0 ".concat(f," ").concat(f),children:[(0,r.jsx)("circle",{r:g,cx:"50%",cy:"50%",fill:"transparent",style:{strokeWidth:u,stroke:"#ffffff2e"}}),(0,r.jsx)("circle",{id:"bar",r:g,cx:"50%",cy:"50%",fill:"transparent",strokeDasharray:v,strokeDashoffset:v-(m?b%1:Math.min(b,1))*v,style:{strokeWidth:u,stroke:"#92e1ffd9",transform:"rotate(-90deg)",transformOrigin:"center",strokeLinecap:"round",transition:"200ms"}})]})})}var u=n(92618),d=n(12839),f=n(43066),m=n(52719),p=n(62361);function h(e){var t,n,s,h;let{run:g=!0,refreshKey:v,popPlacement:k,forceOpen:w,freshFunction:b,freshEach:x=1e3,totalDuration:Z=6e4,className:S,circleBodyClassName:I,disabled:y=!1}=e,A=(0,o.useRef)(),[P,j]=(0,o.useState)(!1);(0,f.N)({loop:x,disable:!P});let{documentVisible:T,documentVisibleRef:C}=(0,i.x)(),[N,L,R]=(0,p.$)(!1),D=()=>L(!0),M=()=>L(!1),E=(0,l.ZP)(e=>e.isMobile),Y=null===(t=l.ZP.getState().refreshCircleLastTimestamp[v])||void 0===t?void 0:t.endTimestamp,U=null===(n=l.ZP.getState().refreshCircleLastTimestamp[v])||void 0===n?void 0:n.endProcessPercent,F=Y&&U&&(Date.now()-Y)/Z+U;return(0,m.L)(()=>{if(!d.N9)return F&&F>1&&(null==b||b()),()=>{var e;l.ZP.setState(t=>{var n;return{refreshCircleLastTimestamp:{...t.refreshCircleLastTimestamp,[v]:{endTimestamp:Date.now(),endProcessPercent:null!==(e=null===(n=A.current)||void 0===n?void 0:n.currentProgressPercent)&&void 0!==e?e:0}}}})}},[]),(0,o.useEffect)(()=>{if(y||!R()||!C.current)return;let e=setTimeout(()=>{!y&&R()&&C.current&&(null==b||b(),M())},0);return()=>clearTimeout(e)},[N,T,y]),(0,r.jsxs)(u.Z,{className:(0,a.m)("select-none",S),placement:k,forceOpen:w,triggerBy:E?"press":void 0,autoClose:!0,onOpen:()=>j(!0),onClose:()=>j(!1),children:[(0,r.jsx)(c,{run:g&&!y,initPercent:F&&F%1,duration:Z,componentRef:A,className:(0,a.m)("clickable clickable-filter-effect",I),onClick:()=>{var e;D(),null===(e=A.current)||void 0===e||e.restart()},onEnd:()=>{var e;D(),null===(e=A.current)||void 0===e||e.restart()}}),(0,r.jsx)(u.Z.Panel,{children:(0,r.jsxs)("div",{className:"w-60",children:["Displayed data will auto-refresh after"," ",Math.round(Z/1e3*(1-(null!==(h=null===(s=A.current)||void 0===s?void 0:s.currentProgressPercent)&&void 0!==h?h:0)))," seconds. Click this circle to update manually."]})})]})}},60534:function(e,t,n){n.d(t,{r:function(){return w}});var r=n(85893),o=n(67294),a=n(91371),l=n(77023),s=n(1151),i=n(65737),c=n(53002),u=n(43067),d=n(6994),f=n(97664),m=n(48162),p=n(6325),h=n(51800),g=n(62952),v=n(81451),k=n(72573);function w(){let e=(0,c.Z)(e=>e.connected),t=(0,c.Z)(e=>e.balances),n=(0,c.Z)(e=>e.tokenAccounts),w=(0,i.Z)(e=>e.stakeDialogInfo),b=(0,i.Z)(e=>e.stakeDialogMode),x=(0,i.Z)(e=>e.isStakeDialogOpen),[Z,S]=(0,o.useState)(),I=(0,a.ZP)(e=>e.isApprovePanelShown),y=(0,o.useMemo)(()=>!!(null==w?void 0:w.lpMint)&&n.some(e=>{let{mint:t}=e;return String(t)===String(null==w?void 0:w.lpMint)}),[n,w]),A=(0,o.useMemo)(()=>"deposit"===b?(null==w?void 0:w.lpMint)&&t[String(w.lpMint)]:null==w?void 0:w.userStakedLpAmount,[w,t,b]),P=(0,o.useMemo)(()=>{if((null==w?void 0:w.lp)&&Z)return(0,g.n)(w.lp,Z,{alreadyDecimaled:!0})},[w,Z]);return(0,r.jsx)(p.Z,{open:x,onClose:()=>{S(void 0),i.Z.setState({isStakeDialogOpen:!1})},placement:"from-bottom",children:t=>{let{close:n}=t;return(0,r.jsxs)(d.Z,{className:"backdrop-filter backdrop-blur-xl p-8 rounded-3xl w-[min(468px,100vw)] mobile:w-full border-1.5 border-[rgba(171,196,255,0.2)] bg-cyberpunk-card-bg shadow-cyberpunk-card",size:"lg",children:[(0,r.jsxs)(h.Z,{className:"justify-between items-center mb-6",children:[(0,r.jsx)("div",{className:"text-xl font-semibold text-white",children:"withdraw"===b?"Unstake RAY":"Stake RAY"}),(0,r.jsx)(m.Z,{className:"text-[#ABC4FF] cursor-pointer",heroIconName:"x",onClick:n})]}),(0,r.jsx)(f.Z,{className:"mb-6",topLeftLabel:"Staking RAY",token:null==w?void 0:w.lp,onUserInput:S,maxValue:"withdraw"===b?null==w?void 0:w.userStakedLpAmount:void 0,topRightLabel:"withdraw"===b?(null==w?void 0:w.userStakedLpAmount)?"Deposited:".concat((0,k.B)(null==w?void 0:w.userStakedLpAmount)):"(no deposited)":void 0}),(0,r.jsxs)(h.Z,{className:"flex-col gap-1",children:[(0,r.jsx)(u.Z,{className:"frosted-glass-teal",isLoading:I,validators:[{should:e},{should:null==w?void 0:w.lp},{should:Z},{should:(0,v.gt)(P,0)},{should:(0,v.eg)(A,P),fallbackProps:{children:"Insufficient RAY Balance"}},{should:"withdraw"===b||y,fallbackProps:{children:"withdraw"===b?"No Unstakable RAY":"No Stakable RAY"}}],onClick:()=>{if(!(null==w?void 0:w.lp)||!Z)return;let e=(0,g.n)(w.lp,Z,{alreadyDecimaled:!0});("withdraw"===b?(0,s.Z)(w,{isStaking:!0,amount:e}):(0,l.Z)(w,{isStaking:!0,amount:e})).then(()=>{n()})},children:"withdraw"===b?"Unstake RAY":"Stake RAY"}),(0,r.jsx)(u.Z,{type:"text",disabled:I,className:"text-sm backdrop-filter-none",onClick:n,children:"Cancel"})]})]})}})}}}]);